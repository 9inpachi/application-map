<?xml version='1.1' encoding='UTF-8'?>
<xwikidoc version="1.3" reference="Map.Code.SimpleMap.SimpleMapSheet" locale="">
  <web>Map.Code.SimpleMap</web>
  <name>SimpleMapSheet</name>
  <language/>
  <defaultLanguage>en</defaultLanguage>
  <translation>0</translation>
  <creator>XWiki.Admin</creator>
  <creationDate>1558225154000</creationDate>
  <parent>Map.Code.SimpleMap.SimpleMapClass</parent>
  <author>XWiki.Admin</author>
  <contentAuthor>XWiki.Admin</contentAuthor>
  <date>1558257125000</date>
  <contentUpdateDate>1558257125000</contentUpdateDate>
  <version>5.1</version>
  <title>#if($doc.documentReference.name == 'SimpleMapSheet')SimpleMap Sheet#{else}$services.display.title($doc, {'displayerHint': 'default', 'outputSyntaxId': 'plain/1.0'})#end</title>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>false</hidden>
  <content>{{velocity}}&#xd;
## You can modify this page to customize the presentation of your object.&#xd;
## At first you should keep the default presentation and just save the document.&#xd;
&#xd;
## Get the css and js for the map&#xd;
#set ($discard = $xwiki.ssx.use('Map.Code.Leaflet'))&#xd;
#set ($discard = $xwiki.jsx.use('Map.Code.Leaflet'))&#xd;
#set ($mapId = $util.generateRandomString(5))&#xd;
#set ($currentDoc = $doc.getDocumentReference())&#xd;
&#xd;
## If editing, then display editing options&#xd;
#if ($xcontext.action == 'edit')&#xd;
  #set ($class = $doc.getObject('Map.Code.SimpleMap.SimpleMapClass').xWikiClass)&#xd;
  #foreach ($prop in $class.properties)&#xd;
    ; $prop.prettyName&#xd;
    ; $doc.display($prop.getName())&#xd;
  #end&#xd;
#elseif ($currentDoc == 'xwiki:Map.Code.SimpleMap.SimpleMapSheet' || $currentDoc == 'xwiki:Map.Code.SimpleMap.SimpleMapTemplate')&#xd;
  ## Do nothing&#xd;
#else&#xd;
  ## Create the map&#xd;
  #set ($class = $doc.getObject('Map.Code.SimpleMap.SimpleMapClass'))&#xd;
  #set ($markerLoc = $class.getValue('markerLocation'))&#xd;
  #set ($popupData = $class.getValue('popupData'))&#xd;
&#xd;
  ## Convert popupData to html&#xd;
  #set ($xdom = $services.rendering.parse($popupData, "xwiki/2.1"))&#xd;
  #set ($popupData = $services.rendering.render($xdom, "xhtml/1.0"))&#xd;
&#xd;
  (% class="map-container" id="map-${mapId}" style="width: 100%; height: 400px;" data-location="${markerLoc}" data-popup='${popupData}' %)((()))&#xd;
#end&#xd;
&#xd;
{{/velocity}}</content>
</xwikidoc>